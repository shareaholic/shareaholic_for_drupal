<?php

/**
 * Implements hook_page_attachments().
 */
function shareaholic_page_attachments(array &$attachments) {

}

/**
 * Implements hook_theme().
 */
function shareaholic_theme() {

  return [
    'shareaholic_tos_modal' => [
      'variables' => [
        'path' => '',
      ],
      'template' => 'shareaholic-tos-modal',
    ],
  ];

}

/**
 * Implements hook_preprocess_HOOK().
 */
function shareaholic_preprocess_page(&$variables) {

  if (\Drupal::service('router.admin_context')->isAdminRoute()) {

    $path = '/admin/config/shareaholic/settings';
    $render_message = \Drupal\Core\Render\Markup::create(
      '<strong>Action required: </strong> You\'ve installed Shareaholic for Drupal. We\'re ready when you are. <a href="' . $path . '">Get Started Now</a>.',
      [':status' => $path]
    );

    $settings = \Drupal::config('shareaholic.settings');
    $api_key = $settings->get('api_key');

    if (!$api_key) {
      \Drupal::messenger()->addMessage($render_message, 'warning');
    }


  }

}